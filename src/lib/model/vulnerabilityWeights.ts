// ─── Vulnerability Weights (Statistics Canada) ─────────────────────────────

/**
 * Source:
 * Statistics Canada – Disability in Canada (2024)
 * https://www150.statcan.gc.ca/n1/pub/89-654-x/89-654-x2024001-eng.htm
 *
 * Weights are informed by national disability prevalence patterns.
 * Values reflect relative burden impact, not raw percentages.
 */

export const VULNERABILITY_WEIGHTS = {
  chronicPain: 0.25, // most prevalent (~62%)
  mobility: 0.2, // high prevalence (~39%)
  cognitive: 0.15, // functional + communication risk
  sensory: 0.15, // vision + hearing combined
  language: 0.1, // communication barriers
  alone: 0.1, // social vulnerability
} as const

export type VulnerabilityKey = keyof typeof VULNERABILITY_WEIGHTS

export function computeVulnerabilityMultiplier(profile: {
  chronicPain?: boolean
  mobility?: boolean
  cognitive?: boolean
  sensory?: boolean
  language?: boolean
  alone?: boolean
}): number {
  let multiplier = 0
  if (profile.chronicPain) multiplier += VULNERABILITY_WEIGHTS.chronicPain
  if (profile.mobility) multiplier += VULNERABILITY_WEIGHTS.mobility
  if (profile.cognitive) multiplier += VULNERABILITY_WEIGHTS.cognitive
  if (profile.sensory) multiplier += VULNERABILITY_WEIGHTS.sensory
  if (profile.language) multiplier += VULNERABILITY_WEIGHTS.language
  if (profile.alone) multiplier += VULNERABILITY_WEIGHTS.alone
  
  // Normalize to 0-1 range, then scale to multiplier (1.0 = no barriers, ~2.5 = max)
  return 1 + (multiplier * 1.5)
}
